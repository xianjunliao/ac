(function($){'use strict';$.extend($.fn.bootstrapTable.defaults,{fixedColumns:false,fixedNumber:1});var BootstrapTable=$.fn.bootstrapTable.Constructor,_initHeader=BootstrapTable.prototype.initHeader,_initBody=BootstrapTable.prototype.initBody,_resetView=BootstrapTable.prototype.resetView;BootstrapTable.prototype.initFixedColumns=function(){this.$fixedHeader=$(['<div class="fixed-table-header-columns">','<table>','<thead></thead>','</table>','</div>'].join(''));this.timeoutHeaderColumns_=0;this.$fixedHeader.find('table').attr('class',this.$el.attr('class'));this.$fixedHeaderColumns=this.$fixedHeader.find('thead');this.$tableHeader.before(this.$fixedHeader);this.$fixedBody=$(['<div class="fixed-table-body-columns">','<table>','<tbody></tbody>','</table>','</div>'].join(''));this.timeoutBodyColumns_=0;this.$fixedBody.find('table').attr('class',this.$el.attr('class'));this.$fixedBodyColumns=this.$fixedBody.find('tbody');this.$tableBody.before(this.$fixedBody)};BootstrapTable.prototype.checkAll=function(){this.checkAll_(true);if(this._$selectItem){this._checkAll_(true)}};BootstrapTable.prototype.uncheckAll=function(){this.checkAll_(false);if(this._$selectItem){this._checkAll_(false)}};BootstrapTable.prototype._checkAll_=function(checked){var rows;if(!checked){rows=this.getSelections()}this.$selectAll.add(this.$selectAll_).prop('checked',checked);this._$selectItem.filter(':enabled').prop('checked',checked);this.updateRows();if(checked){rows=this.getSelections()}this.trigger(checked?'check-all':'uncheck-all',rows)};BootstrapTable.prototype._updateSelected=function(){var checkAll=this._$selectItem.filter(':enabled').length&&this._$selectItem.filter(':enabled').length===this._$selectItem.filter(':enabled').filter(':checked').length;this._$selectItem.each(function(){$(this).closest('tr')[$(this).prop('checked')?'addClass':'removeClass']('selected')})};BootstrapTable.prototype.initHeader=function(){_initHeader.apply(this,Array.prototype.slice.apply(arguments));if(!this.options.fixedColumns){return}this.initFixedColumns();var that=this,$trs=this.$header.find('tr').clone();$trs.each(function(){$(this).find('th:gt('+that.options.fixedNumber+')').remove()});this.$fixedHeaderColumns.html('').append($trs);this.$selectAll=this.$fixedHeaderColumns.find('[name="btSelectAll"]');this.$selectAll.off('click').on('click',function(){var checked=$(this).prop('checked');that[checked?'checkAll':'uncheckAll']();that.updateSelected();that._updateSelected()})};var sprintf=function(str){var args=arguments,flag=true,i=1;str=str.replace(/%s/g,function(){var arg=args[i++];if(typeof arg==='undefined'){flag=false;return''}return arg});return flag?str:''};BootstrapTable.prototype.initBody=function(){_initBody.apply(this,Array.prototype.slice.apply(arguments));if(!this.options.fixedColumns){return}var that=this,rowspan=0;this.$fixedBodyColumns.html('');this.$body.find('> tr[data-index]').each(function(){var $tr=$(this).clone(),$tds=$tr.find('td');$tr.html('');var end=that.options.fixedNumber;if(rowspan>0){--end;--rowspan}for(var i=0;i<end;i++){$tr.append($tds.eq(i).clone())}that.$fixedBodyColumns.append($tr);if($tds.eq(0).attr('rowspan')){rowspan=$tds.eq(0).attr('rowspan')-1}});this._$selectItem=this.$fixedBodyColumns.find('[name="btSelectItem"]')||{};console.log(this._$selectItem);this._$selectItem.off('click').on('click',function(event){event.stopImmediatePropagation();var _this=this;var $this,checked,row;that.$body.find('[name="btSelectItem"]').each(function(){if($(this).attr('data-index')==$(_this).attr('data-index')){$this=$(this);checked=$this.prop('checked');row=that.data[$this.data('index')];if(!checked){$this.prop('checked',true)}else{$this.prop('checked',false)}return}});if(that.options.maintainSelected&&$($this[0]).is(':radio')){$.each(that.options.data,function(i,row){row[that.header.stateField]=false})}row[that.header.stateField]=!checked;if(that.options.singleSelect){that.$selectItem.not($this[0]).each(function(){that.data[$(this).data('index')][that.header.stateField]=false});console.log(that.$selectItem.filter(':checked').not(this));that.$selectItem.filter(':checked').not($this[0]).prop('checked',false)}that.updateSelected();that._updateSelected();that.trigger(checked?'check':'uncheck',row,$this)})};BootstrapTable.prototype.resetView=function(){_resetView.apply(this,Array.prototype.slice.apply(arguments));if(!this.options.fixedColumns){return}clearTimeout(this.timeoutHeaderColumns_);this.timeoutHeaderColumns_=setTimeout($.proxy(this.fitHeaderColumns,this),this.$el.is(':hidden')?100:0);clearTimeout(this.timeoutBodyColumns_);this.timeoutBodyColumns_=setTimeout($.proxy(this.fitBodyColumns,this),this.$el.is(':hidden')?100:0)};BootstrapTable.prototype.fitHeaderColumns=function(){var that=this,visibleFields=this.getVisibleFields(),headerWidth=0;this.$body.find('tr:first-child:not(.no-records-found) > *').each(function(i){var $this=$(this),index=i;if(i>=that.options.fixedNumber){return false}if(that.options.detailView&&!that.options.cardView){index=i-1}that.$fixedHeader.find('th[data-field="'+visibleFields[index]+'"]').find('.fht-cell').width($this.innerWidth());headerWidth+=$this.outerWidth()});this.$fixedHeader.width(headerWidth+1).show()};BootstrapTable.prototype.fitBodyColumns=function(){var that=this,top=-(parseInt(this.$el.css('margin-top'))-2),height=this.$tableBody.height()-18;if(!this.$body.find('> tr[data-index]').length){this.$fixedBody.hide();return}if(!this.options.height){top=this.$fixedHeader.height();height=height-top}this.$fixedBody.css({width:this.$fixedHeader.width(),height:height,top:top}).show();this.$body.find('> tr').each(function(i){that.$fixedBody.find('tr:eq('+i+')').height($(this).height()-1)});this.$tableBody.on('scroll',function(){that.$fixedBody.find('table').css('top',-$(this).scrollTop())});this.$body.find('> tr[data-index]').off('hover').hover(function(){var index=$(this).data('index');that.$fixedBody.find('tr[data-index="'+index+'"]').addClass('hover')},function(){var index=$(this).data('index');that.$fixedBody.find('tr[data-index="'+index+'"]').removeClass('hover')});this.$fixedBody.find('tr[data-index]').off('hover').hover(function(){var index=$(this).data('index');that.$body.find('tr[data-index="'+index+'"]').addClass('hover')},function(){var index=$(this).data('index');that.$body.find('> tr[data-index="'+index+'"]').removeClass('hover')})}})(jQuery);